# Docker-ะบะพะผะฐะฝะดั ั ะฟะพะดัะพะฑะฝัะผะธ ะพะฑัััะฝะตะฝะธัะผะธ

ะญัะพั ัะฐะนะป ัะพะดะตัะถะธั ะฒัะต ะบะพะผะฐะฝะดั ะดะปั ัะฐะฑะพัั ั Docker-ะฟัะธะปะพะถะตะฝะธะตะผ ะบะฐะปัะบัะปััะพัะฐ ะธ ะดะตัะฐะปัะฝัะต ะพะฑัััะฝะตะฝะธั ะบะฐะถะดะพะน ะธะท ะฝะธั.

---

## ๐ 1. ะะตัะตัะพะด ะฒ ะดะธัะตะบัะพัะธั ะฟัะพะตะบัะฐ

```bash
cd /Users/nikolay/Desktop/Calc/calculator-docker-course
```

### ะะฑัััะฝะตะฝะธะต:
- `cd` โ ะบะพะผะฐะฝะดะฐ **C**hange **D**irectory (ัะผะตะฝะธัั ะดะธัะตะบัะพัะธั)
- ะั ะฟะตัะตัะพะดะธะผ ะฒ ะบะพัะตะฝั ะฟัะพะตะบัะฐ, ะณะดะต ะฝะฐัะพะดะธััั ัะฐะนะป `docker-compose.yml`
- **ะะพัะตะผั ััะพ ะฒะฐะถะฝะพ:** Docker Compose ะธัะตั ัะฐะนะป `docker-compose.yml` ะฒ ัะตะบััะตะน ะดะธัะตะบัะพัะธะธ. ะะตะท ะฟะตัะตัะพะดะฐ ะฒ ะฟัะฐะฒะธะปัะฝัั ะฟะฐะฟะบั ะบะพะผะฐะฝะดั `docker compose` ะฝะต ะฝะฐะนะดัั ะบะพะฝัะธะณััะฐัะธั.

---

## ๐ 2. ะัะพะฒะตัะบะฐ ะทะฐะฟััะตะฝะฝัั ะบะพะฝัะตะนะฝะตัะพะฒ

```bash
docker ps -a --filter "name=calc" --format "table {{.Names}}\t{{.Status}}\t{{.Ports}}"
```

### ะะฑัััะฝะตะฝะธะต:
- `docker ps` โ ะฟะพะบะฐะทะฐัั ะทะฐะฟััะตะฝะฝัะต ะบะพะฝัะตะนะฝะตัั
- `-a` (all) โ ะฟะพะบะฐะทะฐัั ะะกะ ะบะพะฝัะตะนะฝะตัั, ะฒะบะปััะฐั ะพััะฐะฝะพะฒะปะตะฝะฝัะต
- `--filter "name=calc"` โ ัะธะปัััะพะฒะฐัั ะฟะพ ะธะผะตะฝะธ, ัะพะดะตัะถะฐัะตะผั "calc"
- `--format "table {{.Names}}..."` โ ัะพัะผะฐัะธัะพะฒะฐัั ะฒัะฒะพะด ะฒ ัะฐะฑะปะธัั ั ะบะพะปะพะฝะบะฐะผะธ:
  - `{{.Names}}` โ ะธะผะตะฝะฐ ะบะพะฝัะตะนะฝะตัะพะฒ
  - `{{.Status}}` โ ััะฐััั (Up, Exited, Created)
  - `{{.Ports}}` โ ะฟัะพะฑัะพัะตะฝะฝัะต ะฟะพััั

### ะงัะพ ัะฒะธะดะธะผ:
```
NAMES           STATUS                    PORTS
calc-frontend   Up 49 minutes             0.0.0.0:3001->80/tcp
calc-backend    Up 49 minutes (healthy)   0.0.0.0:8080->8080/tcp
```

- `(healthy)` โ ะพะทะฝะฐัะฐะตั, ััะพ healthcheck ะฟัะพัะพะดะธั ััะฟะตัะฝะพ

---

## ๐ฅ 3. ะัะพะฒะตัะบะฐ ะทะดะพัะพะฒัั Backend (Health Check)

```bash
curl -s http://localhost:8080/api/health
```

### ะะฑัััะฝะตะฝะธะต:
- `curl` โ ััะธะปะธัะฐ ะบะพะผะฐะฝะดะฝะพะน ัััะพะบะธ ะดะปั ะฒัะฟะพะปะฝะตะฝะธั HTTP-ะทะฐะฟัะพัะพะฒ
- `-s` (silent) โ "ัะธัะธะน" ัะตะถะธะผ, ะฝะต ะฟะพะบะฐะทัะฒะฐะตั ะฟัะพะณัะตัั-ะฑะฐั
- `http://localhost:8080` โ ะฐะดัะตั backend-ัะตัะฒะธัะฐ ะฝะฐ ะปะพะบะฐะปัะฝะพะน ะผะฐัะธะฝะต:
  - `localhost` โ ะฒะฐั ะบะพะผะฟัััะตั (127.0.0.1)
  - `8080` โ ะฟะพัั, ะฟัะพะฑัะพัะตะฝะฝัะน ะธะท Docker-ะบะพะฝัะตะนะฝะตัะฐ
- `/api/health` โ endpoint ะดะปั ะฟัะพะฒะตัะบะธ ัะฐะฑะพัะพัะฟะพัะพะฑะฝะพััะธ ัะตัะฒะธัะฐ

### ะงัะพ ะฟะพะปััะธะผ:
```json
{"service":"calc-backend","status":"OK"}
```

### ะะฐัะตะผ ะฝัะถะตะฝ Health Endpoint:
1. **Docker healthcheck** โ Docker ะฟะตัะธะพะดะธัะตัะบะธ ะฟัะพะฒะตััะตั ััะพั endpoint
2. **Kubernetes probes** โ liveness/readiness ะฟัะพะฒะตัะบะธ
3. **Load Balancer** โ ะพะฟัะตะดะตะปัะตั, ะถะธะฒะพะน ะปะธ ัะตัะฒะตั
4. **ะะพะฝะธัะพัะธะฝะณ** โ Prometheus/Grafana ัะปะตะดัั ะทะฐ ะดะพัััะฟะฝะพัััั

---

## ๐งฎ 4. ะขะตััะธัะพะฒะฐะฝะธะต API ะบะฐะปัะบัะปััะพัะฐ

```bash
curl -s -X POST http://localhost:8080/api/calc \
  -H "Content-Type: application/json" \
  -d '{"a": 10, "b": 5, "op": "+"}'
```

### ะะฑัััะฝะตะฝะธะต:
- `-X POST` โ ัะบะฐะทะฐัั HTTP-ะผะตัะพะด POST (ะฟะพ ัะผะพะปัะฐะฝะธั GET)
- `-H "Content-Type: application/json"` โ ะดะพะฑะฐะฒะธัั HTTP-ะทะฐะณะพะปะพะฒะพะบ:
  - `Content-Type` โ ะณะพะฒะพัะธั ัะตัะฒะตัั, ะฒ ะบะฐะบะพะผ ัะพัะผะฐัะต ัะตะปะพ ะทะฐะฟัะพัะฐ
  - `application/json` โ ัะพัะผะฐั JSON
- `-d '...'` โ ัะตะปะพ ะทะฐะฟัะพัะฐ (data):
  - `"a": 10` โ ะฟะตัะฒะพะต ัะธัะปะพ
  - `"b": 5` โ ะฒัะพัะพะต ัะธัะปะพ  
  - `"op": "+"` โ ะพะฟะตัะฐัะธั (ะดะพัััะฟะฝั: +, -, *, /)

### ะงัะพ ะฟะพะปััะธะผ:
```json
{"result":15.0,"operation":"10.0 + 5.0"}
```

### ะััะณะธะต ะฟัะธะผะตัั:
```bash
# ะััะธัะฐะฝะธะต
curl -s -X POST http://localhost:8080/api/calc \
  -H "Content-Type: application/json" \
  -d '{"a": 100, "b": 37, "op": "-"}'

# ะฃะผะฝะพะถะตะฝะธะต
curl -s -X POST http://localhost:8080/api/calc \
  -H "Content-Type: application/json" \
  -d '{"a": 7, "b": 8, "op": "*"}'

# ะะตะปะตะฝะธะต
curl -s -X POST http://localhost:8080/api/calc \
  -H "Content-Type: application/json" \
  -d '{"a": 144, "b": 12, "op": "/"}'
```

---

## ๐ 5. ะัะพะฒะตัะบะฐ Frontend (nginx)

```bash
curl -s -o /dev/null -w "HTTP Status: %{http_code}\nContent-Type: %{content_type}\n" http://localhost:3001
```

### ะะฑัััะฝะตะฝะธะต:
- `-o /dev/null` โ ะพัะฑัะพัะธัั ัะตะปะพ ะพัะฒะตัะฐ (ะพัะฟัะฐะฒะธัั ะฒ "ัััะฝัั ะดััั")
- `-w "..."` โ ัะพัะผะฐั ะฒัะฒะพะดะฐ (write-out), ะฟะพะบะฐะทะฐัั ะผะตัะฐะดะฐะฝะฝัะต:
  - `%{http_code}` โ HTTP ััะฐััั-ะบะพะด (200, 404, 500...)
  - `%{content_type}` โ MIME-ัะธะฟ ะบะพะฝัะตะฝัะฐ
- `http://localhost:3001` โ Frontend-ัะตัะฒะธั:
  - ะะพัั 3001 ะฟัะพะฑัะพัะตะฝ ะธะท ะบะพะฝัะตะนะฝะตัะฐ (ะฒะฝัััะธ nginx ัะปััะฐะตั ะฟะพัั 80)

### ะงัะพ ะฟะพะปััะธะผ:
```
HTTP Status: 200
Content-Type: text/html
```

### ะะฐััะธััะพะฒะบะฐ:
- `200` โ ััะฟะตัะฝัะน ะพัะฒะตั (OK)
- `text/html` โ ัะตัะฒะตั ะพัะดะฐัั HTML-ัััะฐะฝะธัั (React-ะฟัะธะปะพะถะตะฝะธะต)

---

## ๐ 6. ะัะพะฒะตัะบะฐ ะฟัะพะบัะธ nginx โ backend

```bash
curl -s -X POST http://localhost:3001/api/calc \
  -H "Content-Type: application/json" \
  -d '{"a": 7, "b": 3, "op": "*"}'
```

### ะะฑัััะฝะตะฝะธะต:
ะญัะพั ะทะฐะฟัะพั ะธะดัั ะฝะฐ **Frontend (nginx)**, ะฝะพ ะฟััั `/api/calc`.

### ะะฐะบ ัะฐะฑะพัะฐะตั ะผะฐัััััะธะทะฐัะธั:
```
1. ะะปะธะตะฝั โ http://localhost:3001/api/calc
2. nginx ะฒะธะดะธั ะฟััั /api/ โ ะฟัะธะผะตะฝัะตั ะฟัะฐะฒะธะปะพ proxy_pass
3. nginx โ http://backend:8080/api/calc (ะฒะฝัััะตะฝะฝัั ัะตัั Docker)
4. Backend ะพะฑัะฐะฑะฐััะฒะฐะตั ะทะฐะฟัะพั, ะฒะพะทะฒัะฐัะฐะตั ัะตะทัะปััะฐั
5. nginx โ ะะปะธะตะฝั (ะพัะฒะตั)
```

### ะะพะฝัะธะณััะฐัะธั nginx (ะธะท nginx.compose.conf):
```nginx
location /api/ {
    proxy_pass http://backend:8080;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
}
```

### ะะพัะตะผั ััะพ ะฒะฐะถะฝะพ:
- ะัะฐัะทะตั ะทะฐะณััะถะฐะตั React-ะฟัะธะปะพะถะตะฝะธะต ั http://localhost:3001
- JavaScript ะดะตะปะฐะตั fetch ะฝะฐ `/api/calc` (ะพัะฝะพัะธัะตะปัะฝัะน ะฟััั)
- ะะฐะฟัะพั ััะพะดะธั ะฝะฐ ัะพั ะถะต ะดะพะผะตะฝ: http://localhost:3001/api/calc
- nginx ะฟัะพะบัะธััะตั ะตะณะพ ะฒ backend
- **ะะตั ะฟัะพะฑะปะตะผ ั CORS** โ ะทะฐะฟัะพั ะฝะฐ ัะพั ะถะต origin

---

## ๐ 7. ะัะพัะผะพัั ะปะพะณะพะฒ ะบะพะฝัะตะนะฝะตัะพะฒ

```bash
docker logs calc-backend --tail=10
```

### ะะฑัััะฝะตะฝะธะต:
- `docker logs` โ ะฟะพะบะฐะทะฐัั ะปะพะณะธ ะบะพะฝัะตะนะฝะตัะฐ
- `calc-backend` โ ะธะผั ะบะพะฝัะตะนะฝะตัะฐ
- `--tail=10` โ ะฟะพะบะฐะทะฐัั ัะพะปัะบะพ ะฟะพัะปะตะดะฝะธะต 10 ัััะพะบ

### ะะพะฟะพะปะฝะธัะตะปัะฝัะต ะพะฟัะธะธ:
```bash
# ะกะปะตะดะธัั ะทะฐ ะปะพะณะฐะผะธ ะฒ ัะตะฐะปัะฝะพะผ ะฒัะตะผะตะฝะธ (Ctrl+C ะดะปั ะฒััะพะดะฐ)
docker logs calc-backend -f

# ะะพะณะธ ะทะฐ ะฟะพัะปะตะดะฝะธะน ัะฐั
docker logs calc-backend --since 1h

# ะะพะณะธ ั timestamps
docker logs calc-backend -t

# ะะพะณะธ ะพะฑะพะธั ะบะพะฝัะตะนะฝะตัะพะฒ ัะตัะตะท compose
docker compose logs -f
```

### ะัะธะผะตั ะฒัะฒะพะดะฐ:
```
18:02:09.463 [http-nio-8080-exec-6] DEBUG CalcController - ะะพะปััะตะฝ ะทะฐะฟัะพั: {a=10, b=5, op=+}
18:02:09.466 [http-nio-8080-exec-6] INFO  CalcController - ะััะธัะปะตะฝะธะต: 10.0 + 5.0
18:02:09.467 [http-nio-8080-exec-6] INFO  CalcController - ะะตะทัะปััะฐั: 10.0 + 5.0 = 15.0
```

### ะฃัะพะฒะฝะธ ะปะพะณะธัะพะฒะฐะฝะธั:
- `DEBUG` โ ะดะตัะฐะปัะฝะฐั ะพัะปะฐะดะพัะฝะฐั ะธะฝัะพัะผะฐัะธั
- `INFO` โ ะธะฝัะพัะผะฐัะธะพะฝะฝัะต ัะพะพะฑัะตะฝะธั
- `WARN` โ ะฟัะตะดัะฟัะตะถะดะตะฝะธั (ะฝะฐะฟัะธะผะตั, ะดะตะปะตะฝะธะต ะฝะฐ ะฝะพะปั)
- `ERROR` โ ะพัะธะฑะบะธ

---

## ๐ผ๏ธ 8. ะะฝัะพัะผะฐัะธั ะพ Docker-ะพะฑัะฐะทะฐั

```bash
docker images --filter "reference=*calc*" --format "table {{.Repository}}\t{{.Tag}}\t{{.Size}}\t{{.CreatedSince}}"
```

### ะะฑัััะฝะตะฝะธะต:
- `docker images` โ ะฟะพะบะฐะทะฐัั ะปะพะบะฐะปัะฝัะต Docker-ะพะฑัะฐะทั
- `--filter "reference=*calc*"` โ ัะพะปัะบะพ ะพะฑัะฐะทั ั "calc" ะฒ ะธะผะตะฝะธ
- `--format "table ..."` โ ัะพัะผะฐัะธัะพะฒะฐะฝะฝัะน ะฒัะฒะพะด:
  - `{{.Repository}}` โ ะธะผั ัะตะฟะพะทะธัะพัะธั/ะพะฑัะฐะทะฐ
  - `{{.Tag}}` โ ัะตะณ (ะฒะตััะธั)
  - `{{.Size}}` โ ัะฐะทะผะตั ะพะฑัะฐะทะฐ
  - `{{.CreatedSince}}` โ ะบะพะณะดะฐ ัะพะทะดะฐะฝ

### ะงัะพ ัะฒะธะดะธะผ:
```
REPOSITORY            TAG       SIZE      CREATED
calc-backend-image    latest    471MB     About an hour ago
calc-frontend-image   latest    82.6MB    About an hour ago
```

### ะะพัะตะผั frontend ะผะตะฝััะต:
- Frontend ะธัะฟะพะปัะทัะตั **multi-stage build**:
  1. Stage 1 (builder): node:20-alpine ัะพะฑะธัะฐะตั React โ ~1GB
  2. Stage 2 (runtime): nginx:alpine + ััะฐัะธัะตัะบะธะต ัะฐะนะปั โ 82MB
- ะ ัะธะฝะฐะปัะฝัะน ะพะฑัะฐะท ะฟะพะฟะฐะดะฐะตั ัะพะปัะบะพ nginx ะธ ัะพะฑัะฐะฝะฝัะต ัะฐะนะปั

---

## ๐ 9. ะะฐะฟััะบ ะฟัะธะปะพะถะตะฝะธั (ะตัะปะธ ะพััะฐะฝะพะฒะปะตะฝะพ)

```bash
docker compose up --build -d
```

### ะะฑัััะฝะตะฝะธะต:
- `docker compose up` โ ะทะฐะฟัััะธัั ัะตัะฒะธัั ะธะท docker-compose.yml
- `--build` โ ะฟะตัะตัะพะฑัะฐัั ะพะฑัะฐะทั ะฟะตัะตะด ะทะฐะฟััะบะพะผ
- `-d` (detached) โ ะทะฐะฟัััะธัั ะฒ ัะพะฝะพะฒะพะผ ัะตะถะธะผะต

### ะงัะพ ะฟัะพะธััะพะดะธั:
1. Docker ัะธัะฐะตั `docker-compose.yml`
2. ะะปั ะบะฐะถะดะพะณะพ ัะตัะฒะธัะฐ (backend, frontend):
   - ะกะพะฑะธัะฐะตั ะพะฑัะฐะท ะธะท Dockerfile (ะตัะปะธ `--build`)
   - ะกะพะทะดะฐัั ะบะพะฝัะตะนะฝะตั
   - ะะฐัััะฐะธะฒะฐะตั ัะตัั, ะฟะพััั, volumes
3. ะะฐะฟััะบะฐะตั ะบะพะฝัะตะนะฝะตัั
4. ะะดัั healthcheck ะดะปั backend
5. ะะฐะฟััะบะฐะตั frontend (depends_on ั condition)

---

## โน๏ธ 10. ะััะฐะฝะพะฒะบะฐ ะฟัะธะปะพะถะตะฝะธั

```bash
docker compose down
```

### ะะฑัััะฝะตะฝะธะต:
- `docker compose down` โ ะพััะฐะฝะพะฒะธัั ะธ ัะดะฐะปะธัั ะบะพะฝัะตะนะฝะตัั
- ะขะฐะบะถะต ัะดะฐะปัะตั ัะพะทะดะฐะฝะฝัั Docker-ัะตัั

### ะะพะฟะพะปะฝะธัะตะปัะฝัะต ะพะฟัะธะธ:
```bash
# ะฃะดะฐะปะธัั ัะฐะบะถะต volumes (ะดะฐะฝะฝัะต)
docker compose down -v

# ะฃะดะฐะปะธัั ัะฐะบะถะต ะพะฑัะฐะทั
docker compose down --rmi all

# ะฃะดะฐะปะธัั ะฒัั: ะบะพะฝัะตะนะฝะตัั, ัะตัะธ, volumes, ะพะฑัะฐะทั
docker compose down -v --rmi all
```

---

## ๐ง 11. ะะพะปะตะทะฝัะต ะบะพะผะฐะฝะดั ะพัะปะฐะดะบะธ

### ะะฐะนัะธ ะฒะฝัััั ะบะพะฝัะตะนะฝะตัะฐ:
```bash
docker exec -it calc-backend /bin/sh
```
- `-it` โ ะธะฝัะตัะฐะบัะธะฒะฝัะน ัะตะถะธะผ ั ัะตัะผะธะฝะฐะปะพะผ
- `/bin/sh` โ ะทะฐะฟัััะธัั shell (ะฒ alpine ะฝะตั bash)

### ะะพัะผะพััะตัั ะธัะฟะพะปัะทะพะฒะฐะฝะธะต ัะตััััะพะฒ:
```bash
docker stats calc-backend calc-frontend
```

### ะะพัะผะพััะตัั ะบะพะฝัะธะณััะฐัะธั ะบะพะฝัะตะนะฝะตัะฐ:
```bash
docker inspect calc-backend
```

### ะัะพะฒะตัะธัั ัะตัะตะฒะพะต ะฟะพะดะบะปััะตะฝะธะต ะผะตะถะดั ะบะพะฝัะตะนะฝะตัะฐะผะธ:
```bash
docker exec calc-frontend ping -c 3 backend
```

---

## ๐ ะัะพะณะพะฒะฐั ััะตะผะฐ ัะฐะฑะพัั

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                         ะะะะฃะะะ                              โ
โ                    http://localhost:3001                     โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                              โ
                              โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                    FRONTEND (nginx)                          โ
โ                    ะะพะฝัะตะนะฝะตั: calc-frontend                  โ
โ                    ะะพัั: 3001 โ 80                           โ
โ                                                              โ
โ    /               โ ะัะดะฐัั React (index.html, JS, CSS)     โ
โ    /api/*          โ ะัะพะบัะธััะตั ะฒ backend:8080              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                              โ
                              โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                    BACKEND (Spring Boot)                     โ
โ                    ะะพะฝัะตะนะฝะตั: calc-backend                   โ
โ                    ะะพัั: 8080                                โ
โ                                                              โ
โ    /api/health     โ Health check                           โ
โ    /api/calc       โ ะะฐะปัะบัะปััะพั (POST)                     โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

*ะคะฐะนะป ัะพะทะดะฐะฝ ะฐะฒัะพะผะฐัะธัะตัะบะธ ะฟัะธ ะทะฐะฟััะบะต ะฟัะธะปะพะถะตะฝะธั*

